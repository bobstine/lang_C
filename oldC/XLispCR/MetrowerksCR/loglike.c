#include <stdlib.h>#include <stdio.h>#include <math.h>#include <time.h>// Prototypesvoid main (void);void logLike(long *y, double *s, long *n, double *alpha, double *beta, double *ll);void BuildBiCoefTable (long *n);// Loglike code/* Globals */double **biCoef;long  biCoefLen = 0;void BuildBiCoefTable (long *n){	long i,j;	double *pBC;		biCoefLen = *n;	biCoef = (double **) malloc((1+biCoefLen) * sizeof(double *));  // Allocate table	for(i=0; i<=biCoefLen; ++i)		biCoef[i] = (double *) malloc((i+1) * sizeof(double));			*biCoef[0] = 1.0;												// Fill table	for (i=1; i<=biCoefLen; ++i)	{	*biCoef[i] = 1.0;		pBC = biCoef[i];		++pBC;		for (j=1; j < i; ++j)		 	*pBC++ = biCoef[i-1][j-1] + biCoef[i-1][j];		*pBC = 1.0;	}}#define BinomialCoef(n,k) biCoef[n][k]void logLike(long *y, double *s, long *n, double *alpha, double *beta, double *ll){	long i, j;	double b, sum, sTerm, aTerm, bTerm, dN;		b = *beta/(1+*beta);	dN = (double) *n;	*ll = 0.0;	for (i=0; i<*n; ++i)	{	sTerm = 1.0;		for (j=0; j< *y; ++j) 			sTerm *= *s;		bTerm = 1.0;		aTerm = 1.0;		sum = 0.0;		for (j=0; j<=*y; ++j)		{	sum += BinomialCoef(*y,j) * sTerm * bTerm * aTerm;			printf("sum= %lf ", sum);			sTerm /= *s;			aTerm *= (*alpha)+j;			bTerm *= b;		}		printf ("\n[%ld] log(%lf) = %lf\n", i, sum, log(sum));		++y;		*ll += log(sum) - *s++;	}	*ll -= dN * (*alpha) * log(1.0 + *beta);}// Testing codevoid main(void){	clock_t start, secs;	int     i,j;		long   len = 8;	long   y[8] = {0,1,2,3,4,5,6,7};	double s[8] = {1.1,2.2,3.3,4.4,5.5, 1.1, 2.2, 3.3};	double alpha = 0.5, beta=1.1, ll;		BuildBiCoefTable (&len);	for (i=0; i<=len; ++i)	{	printf ("[%d] ", i);		for (j=0; j<=i; ++j)			printf(" %lf ", BinomialCoef(i,j));		printf("\n");	}	start = clock(); 					// _____ time these calculations	logLike(y, s, &len, &alpha, &beta, &ll);		                 				// _____ check the clock	secs = (clock() - start)/ CLOCKS_PER_SEC;	printf ("That took %lu seconds.\n", secs);	printf ("For alpha=%lf and beta=%lf, logLike = %lf\n", alpha, beta, ll);}