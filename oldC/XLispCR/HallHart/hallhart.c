/*	hallhart.c		26 Apr 95 ... Revised for PPC calling conventions.	25 Aug 91 ... Created to speed simulations.*/#define Sqr(x) ((x)*(x))void hallhart (int *pnObs, double *pData, int *pWidth, double *hhStat);void hallhart(pnObs, pData, pWidth, hhStat)int *pnObs, *pWidth;double *pData, *hhStat;{	int nObs, width, i;	double tot, num, den, diff, *pFirst, *pLast, *pD;		nObs = *pnObs;	width = *pWidth;	tot = 0.0;						/* initialize running total, setting up p's */	pFirst = pLast = pD = pData;	for (i=0; i<width; ++i)		tot += *pLast++;			/* pLast points to next number to add */ 		num = Sqr(tot);	den = 0.0;	for (i=1; i<=nObs-width; ++i)	{	tot += *pLast++ - *pFirst++; /* losing one gains another */		num += Sqr(tot);		diff = *pD++;		diff = diff - *pD;		den += Sqr(diff);	}	pLast = pData;					 /* repeat for circular list */	for (i=0; i<width-1; ++i)	{	tot += *pLast++ - *pFirst++;		num += Sqr(tot);		diff = *pD++;		diff = diff - *pD;		den += Sqr(diff);	}	*hhStat = 2.0 * num / ( ((double)nObs) * den );}