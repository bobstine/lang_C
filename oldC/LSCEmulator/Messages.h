/*		Messages Emulator for decoding messages sent in the				transputer C world.				28 Aug 89 ... Addition of tag packets to request sending of a matrix; return codes.		26 Jul 89 ... Created.		NOTES:  - Message packetCode is echoed of the initial message;				- Return code is the return code set by array processor.				*/#ifndef _Messages_#define _Messages_#include "ArrayDef.h"#include "apInstructions.h"#include "apMachine.h"/*  ________________________  Message codes  _____________________  */#define SCALARCODE 		 0#define VECTORCODE  	 1#define MATRIXCODE		 2#define TAGCODE			 3#define INSTRUCTCODE   	10/*  _____________________  Message structures  _________________  */	typedef struct {	int		packetCode;	int		returnCode;	float	scalar;	} ScalarPacket;typedef struct {	int		packetCode;	int		matrixTag;	} TagPacket;	typedef struct {	int		packetCode;	int		returnCode;	int		len;	float	data[1];	} VectorPacket;typedef struct {	int		packetCode;	int		returnCode;	int		nRows, nCols;	double	data[1];	} MatrixPacket;typedef struct {	int			packetCode;	int			nInst;	Instruction	instArray[1];	} InstPacket;/*  _____________________  Message Conversion  _________________  */void ConvertVectorPacket (VectorPacket *, ScalarPacket *);int  VectorPacketSize (VectorPacket *);void BuildVectorFromPacket (VectorPacket *, Vector *);void BuildVectorPacket (Vector *, VectorPacket **);void ConvertMatrixPacket (MatrixPacket *, ScalarPacket *, ArrayProcessor *);int  MatrixPacketSize (MatrixPacket *);void BuildMatrixFromPacket (MatrixPacket *, Matrix *);void BuildMatrixPacket (int tag, Matrix *mat, MatrixPacket **);void ConvertScalarPacket (ScalarPacket *, ScalarPacket *);void ConvertTagPacket  (TagPacket  *, MatrixPacket **, ArrayProcessor *);void ConvertInstPacket (InstPacket *, ScalarPacket * , ArrayProcessor *);#endif