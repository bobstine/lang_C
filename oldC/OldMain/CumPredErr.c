/*		Simulation of cumulative prediction error of C.Z. Wei			as described in AS 15 (Dec 1987)				19 Sep 88 ... Add parameter to control lower limit of sum.		18 Sep 88 ... Created.*//*  ---------------------  INCLUDE  --------------------------  */#include	<stdio.h>extended sqrt();extended log();#include	"Globals.h"#include	"ArrayDef.h"#include 	"RandomSamples.h"/*  ----------------------  DEFINES  -------------------------  *//*  ----------------------  GLOBALS  -------------------------  */static int			theStart, theLength, theSeed;static double		theCoef;static VECTOR		theData;/*  ----------------------------------------------------------  */static void ParseCmdLine (argc, argv)/* First argument treated is seed, second is length, last is rho.   */int argc;				char *argv[];{	int  arg;		if (argc <= 2)	{	fprintf (stderr, "Args ==> SEED, START, LENGTH, Rho. \n");		exit(1);	}		/* for (arg=0; arg<argc; ++arg)		fprintf (stderr, "argv[%d] --->%s<---\n", arg, argv[arg]); */	sscanf (argv[1], "%d",  &theSeed);	sscanf (argv[2], "%d",  &theStart);		sscanf (argv[3], "%d",  &theLength);	sscanf (argv[4], "%nf", &theCoef);}static void Initialize(){	InitRandomSamples (theSeed);	AllocVector (theLength, &theData);	FillNormalVector (&theData);}main(argc, argv)int argc;				/* count includes tool name */char *argv[];{	int t;	extended firstY, lastY;	/* two current observations */	extended numSum=0, denSum=0, rhoHat, predErr2Sum=0;	extended realT;	extended *errPtr, pe;		ParseCmdLine (argc, argv);		/* and allocate space */	Initialize();					/* set up and run random generators */	errPtr = theData.pntr;	if (theCoef > 1.0)		firstY = *errPtr++;	else		firstY = (*errPtr++) / sqrt(1.0 - theCoef*theCoef);		t = 1;		while (t < theLength)	{	lastY = (*errPtr++) + theCoef * firstY; 	/* inc error pointer */		numSum += lastY * firstY;		denSum += firstY * firstY;		if (t > theStart)		{	rhoHat = numSum / denSum;			pe = (theCoef - rhoHat) * lastY;			predErr2Sum += pe * pe;		}		if ((t%500 == 0) || (t == 50))		{	realT = t;			fprintf(stderr, "Trial #%5d with est rho= %6.4lf", t, rhoHat);			fprintf(stderr, " (Sum PE^2)/log t = %10.5lf\n", predErr2Sum/log(realT));		}		firstY = lastY;							/* shuffle forward */		t += 1;	}		DisposeVector (&theData);}