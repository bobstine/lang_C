/*		 9 Feb 89 ... Created.*/#include "Globals.h"#include "ProbDist.h"#include <math.h>double GaussCDF (x)double x;{	double	result, extra, temp;	Boolean	negative;	negative = (x < 0.0);	if (negative) 		x = -x;	temp = 1.0 / (1.0 + (0.2316419 * x));	extra = 0.3989423 * exp(-x * x / 2.0);	temp = temp * ((((((((1.330274 * temp) - 1.821256) * temp) + 1.781478) * temp) - 0.3565638) * temp) + 0.3193815);	result = 1.0 - (extra * temp);	if (negative) 		result = 1.0 - result;	return (result);}double GaussInv (prob) double prob;{	double temp, result;	Boolean gt_half;	gt_half = (prob > 0.5);	if (gt_half)		prob = 1.0 - prob;	temp = sqrt (-log(prob * prob));	result = 2.515517 + temp * (0.802853 + (temp * 0.010328));	result = result / (1.0 + temp * (1.432788 + temp * (0.189267 + (temp * 0.001308))));	result = result - temp;	if (gt_half) 		result = -result;	return (result);} double TCDF (t, df) double t;int df;{	double zsqr, a, d, z, prob;	a = df - 0.5;	z = sqrt(a * log(1.0 + (t * t / df)));	d = 48.0 * a * a;	zsqr = z * z;	prob = z + z * (3.0 + zsqr) / d;	a = z * (855.0 + zsqr * (240.0 + zsqr * (33.0 + zsqr * 4.0)));	prob -= a / (10 * d * (d + 100.0 + 0.8 * zsqr * zsqr));	return (GaussCDF(prob));} double TInv (prob, df) double prob;int df;{	double res, power, z, zsqr;	prob = 1.0 - (2.0 * (1.0 - prob));	prob = 0.5 + (prob / 2.0);	z = GaussInv(prob);	zsqr = z * z;	res = z + (z + z * zsqr) / (4.0 * df);	power = df * df;	res = res + (z * (3.0 + zsqr * (16.0 + zsqr * 5.0))) / (power * 96.0);	power = df * power;	res = res + (z * (-15.0 + zsqr * (17.0 + zsqr * (19.0 + zsqr * 3.0)))) / (power * 384.0);	power = df * power;	res = res + (z * (-945.0 + zsqr * (-1920.0 + zsqr * (1482.0 + zsqr * (776.0 + zsqr * 79.0))))) / (power * 92160.0);	return ( res );} /*  ___________________  local routines for chi square  __________________  */static double IntPower (double x , int p);static int Factorial (int n);static double TailArea (double x, int df /* and even */);double IntPower (x, p) double x;int p;{	int i;	double res;	res = x;	for (i=2; i<=p; ++i)	 	res *=  x;	return ( res );} int Factorial (n)int n;{	int i, res;	res = 1;	for (i = 2; i<=n; ++i)		 res *= i;	return ( res );} double TailArea (x, df) double x;int df;{	double half, res;	int halfDF;	half = x / 2.0;	if (df == 2)		return ( exp(-half));	else	{		halfDF = (df / 2) - 1;		res = (IntPower(half, halfDF) * exp(-half)) / Factorial(halfDF);		return (res + TailArea(x, df - 2));	}} double Chi2CDF (x, df) double x;int df;{	double xx, yy;	if (df < 17)	{		if ((2 * (df / 2)) != df)			++df;  /* force df even */		return (1.0 - TailArea(x, df));	} else	{	xx = 2.0 / (9.0 * df);		yy = exp(log(x / df) / 3.0);		yy = (yy + xx - 1.0) / (sqrt(xx));		return (GaussCDF(yy));	}}double FCDF (f, numDF, denDF) double f;int numDF;int denDF;{	double a1, a2, a3, a4, z, root;	a1 = 2.0 / (9.0 * denDF);	a2 = 2.0 / (9.0 * numDF);	root = exp((log(f)) / 3.0);	a3 = (1.0 - a1) * root;	a4 = a1 * root * root;	z = (a3 + a2 - 1.0) / sqrt(a2 + a4);	return (GaussCDF(z));} 